<view class="page-container">
  <!-- 页面头部 -->
  <view class="page-header">
    <view class="header-content">
      <view class="header-left">
        <text class="page-title">颜色管理</text>
        <text class="page-subtitle">合计{{filteredColors.length}}，启用{{enabledCount}} 停用{{disabledCount}}</text>
      </view>
      <view class="header-right">
        <view class="add-btn-wrapper">
          <view class="add-btn" bindtap="showAddModal">
            <text class="add-icon">+</text>
            <text class="add-text">新增</text>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- 智能提示卡片 -->
  <view class="ai-tip-card" wx:if="{{!isLoading && filteredColors.length === 0}}">
    <view class="ai-tip-icon">🤖</view>
    <view class="ai-tip-content">
      <text class="ai-tip-title">AI智能建议</text>
      <text class="ai-tip-desc">建议创建常用颜色如：黑色、白色、红色、蓝色、绿色、黄色</text>
    </view>
  </view>

  <!-- 加载状态 -->
  <view class="loading-wrapper" wx:if="{{isLoading}}">
    <view class="loading-content">
      <view class="loading-spinner"></view>
      <text class="loading-text">AI正在加载颜色数据...</text>
    </view>
  </view>

  <!-- 空状态 -->
  <view class="empty-wrapper" wx:elif="{{filteredColors.length === 0}}">
    <view class="empty-content">
      <view class="empty-icon">🎨</view>
      <text class="empty-title">暂无颜色数据</text>
      <text class="empty-desc">点击右上角新增按钮开始创建颜色</text>
      <view class="empty-action">
        <view class="empty-btn" bindtap="showAddModal">立即创建</view>
      </view>
    </view>
  </view>

  <!-- 颜色网格列表 -->
  <view class="color-grid" wx:else>
    <view 
      wx:for="{{filteredColors}}" 
      wx:key="id"
      class="color-card {{item.status === 0 ? 'disabled' : ''}}"
      bindtap="showEditModal" 
      data-color="{{item}}"
    >
      <!-- 卡片头部 -->
      <view class="card-header">
        <view class="color-order-badge">{{item.orderNum || 0}}</view>
        <view class="status-indicator {{item.status === 1 ? 'active' : 'inactive'}}"></view>
      </view>
      
      <!-- 卡片内容 -->
      <view class="card-content">
        <view class="color-name">{{item.name}}</view>
      </view>
      
      <!-- 卡片操作 -->
      <view class="card-actions" catchtap="stopPropagation">
        <view 
          wx:if="{{item.status === 1}}"
          class="action-btn disable-btn"
          bindtap="toggleStatus"
          data-id="{{item.id}}"
          data-status="{{item.status}}"
        >
          <text class="btn-icon">⏸</text>
        </view>
        <view 
          wx:else
          class="action-btn enable-btn"
          bindtap="enableColor"
          data-id="{{item.id}}"
        >
          <text class="btn-icon">▶</text>
        </view>
      </view>
      
      <!-- 状态标签 -->
      <view class="status-badge {{item.status === 1 ? 'status-active' : 'status-disabled'}}">
        {{item.status === 1 ? '启用中' : '已停用'}}
      </view>
    </view>
  </view>

  <!-- 添加颜色弹窗 -->
  <view class="modal-mask" wx:if="{{showModal && modalType === 'add'}}" bindtap="hideModal" catchtouchmove="preventTouchMove"></view>
  <view class="modal-container {{showModal && modalType === 'add' ? 'modal-show' : ''}}" wx:if="{{showModal && modalType === 'add'}}">
    <view class="modal-content">
      <view class="modal-header">
        <text class="modal-title">🆕 新增颜色</text>
        <view class="modal-close" bindtap="hideModal">✕</view>
      </view>
      
      <view class="modal-body">
        <view class="form-section">
          <view class="form-item">
            <text class="form-label">颜色名称</text>
            <input 
              class="form-input" 
              placeholder="请输入颜色名称（如：红色、蓝色）" 
              value="{{formData.name}}" 
              maxlength="20" 
              bindinput="onNameInput" 
              focus="{{showModal && modalType === 'add'}}"
            />
          </view>
          
          <view class="form-item">
            <text class="form-label">显示顺序</text>
            <input 
              class="form-input" 
              type="number"
              placeholder="选填，留空自动排序（数字越小越靠前）" 
              value="{{formData.order}}" 
              bindinput="onOrderInput"
            />
          </view>
        </view>
        
        <view class="ai-suggestion">
          <view class="suggestion-icon">💡</view>
          <view class="suggestion-content">
            <text class="suggestion-title">AI建议</text>
            <text class="suggestion-desc">建议使用标准颜色命名，便于客户理解和选择。显示顺序可留空，系统会自动排序</text>
          </view>
        </view>
      </view>
      
      <view class="modal-footer">
        <view class="footer-btn cancel-btn" bindtap="hideModal">取消</view>
        <view class="footer-btn confirm-btn" bindtap="submitForm">保存</view>
      </view>
    </view>
  </view>

  <!-- 编辑颜色弹窗 -->
  <view class="modal-mask" wx:if="{{showModal && modalType === 'edit'}}" bindtap="hideModal" catchtouchmove="preventTouchMove"></view>
  <view class="modal-container {{showModal && modalType === 'edit' ? 'modal-show' : ''}}" wx:if="{{showModal && modalType === 'edit'}}">
    <view class="modal-content">
      <view class="modal-header">
        <text class="modal-title">✏️ 编辑颜色</text>
        <view class="modal-close" bindtap="hideModal">✕</view>
      </view>
      
      <view class="modal-body">
        <view class="form-section">
          <view class="form-item">
            <text class="form-label">颜色名称</text>
            <input 
              class="form-input" 
              placeholder="请输入颜色名称" 
              value="{{formData.name}}" 
              maxlength="20" 
              bindinput="onNameInput" 
              focus="{{showModal && modalType === 'edit'}}"
            />
          </view>
          
          <view class="form-item">
            <text class="form-label">显示顺序</text>
            <input 
              class="form-input" 
              type="number"
              placeholder="选填，数字越小越靠前" 
              value="{{formData.order}}" 
              bindinput="onOrderInput"
            />
          </view>
        </view>
        
        <view class="edit-warning">
          <view class="warning-icon">⚠️</view>
          <view class="warning-content">
            <text class="warning-title">注意事项</text>
            <text class="warning-desc">修改颜色信息可能影响已关联的产品和订单。显示顺序留空将保持原有排序</text>
          </view>
        </view>
      </view>
      
      <view class="modal-footer">
        <view class="footer-btn cancel-btn" bindtap="hideModal">取消</view>
        <view class="footer-btn confirm-btn" bindtap="submitForm">更新</view>
      </view>
    </view>
  </view>
</view> 